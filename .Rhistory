as.numeric(a12[1,2])
identical(c(0,3),c(3,0))
?set
identical(sort(c(0,3)),sort(c(3,0)))
identical(sort(c(0,3)),sort(c(3,0)))
as.numeric(a11[1,2])
as.numeric(a12[1,2])
a11
a12
a21
a22
identical(c(a11[1,2],a12[1,2]),c(a21[1,2],a22[1,2]))
a11[1,2] <- "3"
identical(c(a11[1,2],a12[1,2]),c(a21[1,2],a22[1,2]))
identical(sort(c(a11[1,2],a12[1,2])),sort(c(a21[1,2],a22[1,2])))
ind1<-sort(c(a11[1,2],a12[1,2]))
ind2<-sort(c(a21[1,2],a22[1,2]))
ind1
ind2
a11<-matrix(sapply(strsplit(as.matrix(b1),"\\|"),"[",1),nrow = n/2,ncol=m,byrow = F)
rownames(a11) <- rownames(b1)
colnames(a11) <- colnames(b1)
a11
ind1<-sort(c(a11[1,2],a12[1,2]))
ind2<-sort(c(a21[1,2],a22[1,2]))
ind2
ind1
intersect(ind1,ind2)
length(intersect(ind1,ind2))
AS <- function(a11,a12,a21,a22){
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
AS(a11[1,1],a12[1,1],a21[1,1],a22[1,1])
a11
a12
a21
a22
a11xa12
a11*a12
cbind(a11,a12)
cbind(a11,a12,a21,a22)
rbind(cbind(a11,a12),cbind(a21,a22)))
rbind(cbind(a11,a12),cbind(a21,a22))
dim(rbind(cbind(a11,a12),cbind(a21,a22)))
MAX<-rbind(cbind(a11,a12),cbind(a21,a22))
MAX
M
n
m
i <- 1
i+ n/2
n
a11
typeof(a11)
AS(a11[1,1],a12[1,1],a21[1,1],a22[1,1])
cel<-c(1,1)
a11[cel]
a11[1,1]
AS(a11[,1],a12[,1],a21[,1],a22[,1])
data.frame(a11)
data.frame(a12)
data.frame(a13)
data.frame(a21)
data.frame(a22)
list(a11,a12,a21,a22)
sapply(list(a11,a12,a21,a22),AS)
a11
data.frame(a22)
sapply(list(a11,a12,a21,a22),AS)
cel<-c(1,1)
a11
unlist(a11)
unmatrix(a11)
list(a11)
as.matrix(a11)
as.data.frame(a11)
unlist(a11)
a11<-as.data.frame(a11)
a12<-as.data.frame(a12)
a21<-as.data.frame(a21)
a22<-as.data.frame(a22)
a11
list(a11,a12,a21,a22)
as.vector(a11)
as.array(a11)
unlist(a11)
unlist(unlist(a11))
a11
a11<-as.matirx(a11)
a11<-as.matrix(a11)
a11
unlist(a11)
sapply(list(a11,a12,a21,a22),AS)
unlist(a11)
sapply(list(a11,a12,a21,a22),AS)
unlist(a11)
a11<-as.data.frame(a11)
a11
a11[1]
unlist(a11[1])
sapply(a11,unlist)
MAX
sapply(MAX,unlist)
a11<-as.data.frame(a11)
a12<-as.data.frame(a12)
a21<-as.data.frame(a21)
a22<-as.data.frame(a22)
MAX <- rbind(cbind(a11,a12),cbind(a21,a22))
sapply(MAX,unlist)
a11<-as.data.frame(a11)
a11
as.matrix(a11)
matrix(a11)
a11<-as.data.frame(a11)
a11
a11<-matrix(sapply(strsplit(as.matrix(b1),"\\|"),"[",1),nrow = n/2,ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),"\\|"),"[",2),nrow = n/2,ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),"\\|"),"[",1),nrow = n/2,ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),"\\|"),"[",2),nrow = n/2,ncol=m,byrow = F)
a11
unlist(a11)
as.numeric(a11)
data.frame((a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))
data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))
t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22)))
MAX <- t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22)))
typeof(MAX)
data.frame(MAX)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
MAX
a11
a21
a12
g1
b1
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
AS(MAX[1])
AS(MAX[,1])
MAX[1]
MAX[1][1]
MAX[[1]]
AS(MAX[[1]])
AS(MAX[[2]])
sapply(MAX, AS)
matrix(sapply(MAX, AS),nrow = n/2,ncol = m)
colnames(output) <- colnames(g1)
output <-matrix(sapply(MAX, AS),nrow = n/2,ncol = m)
colnames(output) <- colnames(g1)
output
rownames(b1)
cbind(rownames(b1),rownames(b2))
pair <-cbind(rownames(b1),rownames(b2))
pair[1,]
paste(pair[1,])
paste(pair)
typeof(pair)
pair
data.frame(pair)
data.frame(pair)
sapply(data.frame(pair),function(x){paste(x[1],x[2])})
pair <-rbind(rownames(b1),rownames(b2))
data.frame(pair)
sapply(data.frame(pair),function(x){paste(x[1],x[2])})
rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
output
AlleleShare <- function(g1,sep){
n <- nrow(g1)
m <- ncol(g1)
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = n/2,ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = n/2,ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = n/2,ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = n/2,ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = n/2,ncol = m)
colnames(output) <- colnames(g1)
pair <-rbind(rownames(b1),rownames(b2))
rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
}
AlleleShare(g1)
AlleleShare(g1,"\\|")
AlleleShare(g1,"\\|")
d<-combn(n,2,simplify = TRUE)
d
d[1,]
d[2.]
d[2,]
d1
d2
b1 <- g1[d[1,],]
b1
b2 <- g1[d[2,],]
b2
nrow(b1)
nrow(b2)
cp<-nrow(b1)
nrow(g1[d1,])
ncol(b1)
ncol(g1[d1,])
AlleleShare <- function(g1,sep,replacement){
n <- nrow(g1)
m <- ncol(g1)
if (replacement){
d<-combn(n,2,simplify = TRUE)
b1 <- g1[d[1,],]
b2 <- g1[d[2,],]
}else{
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
}
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = ncol(b1),ncol = m)
colnames(output) <- colnames(g1)
pair <-rbind(rownames(b1),rownames(b2))
rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
}
AlleleShare(g1,"\\|",replacement = T)
AlleleShare(g1,"\\|",replacement = F)
AlleleShare(g1,"\\|",replacement = F)
AlleleShare <- function(g1,sep,replacement){
n <- nrow(g1)
m <- ncol(g1)
if (replacement){
d<-combn(n,2,simplify = TRUE)
b1 <- g1[d[1,],]
b2 <- g1[d[2,],]
}else{
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
}
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = ncol(b1),ncol = m)
#colnames(output) <- colnames(g1)
#pair <-rbind(rownames(b1),rownames(b2))
#rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
}
AlleleShare <- function(g1,sep,replacement){
n <- nrow(g1)
m <- ncol(g1)
if (replacement){
d<-combn(n,2,simplify = TRUE)
b1 <- g1[d[1,],]
b2 <- g1[d[2,],]
}else{
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
}
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = ncol(b1),ncol = m)
#colnames(output) <- colnames(g1)
#pair <-rbind(rownames(b1),rownames(b2))
#rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
}
AlleleShare(g1,"\\|",replacement = F)
AlleleShare(g1,"\\|",replacement = T)
AlleleShare(g1,"\\|",replacement = T)
ncol(g1)
n <- nrow(g1)
m <- ncol(g1)
replacement <- TRUE
if (replacement){
d<-combn(n,2,simplify = TRUE)
b1 <- g1[d[1,],]
b2 <- g1[d[2,],]
}else{
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
}
b1
b2
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
sep <- "\\|"
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = ncol(b1),ncol = m)
output
output <-matrix(sapply(MAX, AS),nrow = nrow(b1),ncol = m)
#colnames(output) <- colnames(g1)
#pair <-rbind(rownames(b1),rownames(b2))
#rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
AlleleShare <- function(g1,sep,replacement){
n <- nrow(g1)
m <- ncol(g1)
if (replacement){
d<-combn(n,2,simplify = TRUE)
b1 <- g1[d[1,],]
b2 <- g1[d[2,],]
}else{
d1<-sample(n,n/2,replace = FALSE)
d2<-sample(setdiff(c(1:n),d1))
b1<-g1[d1,]
b2<-g1[d2,]
}
a11<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",1),nrow = nrow(b1),ncol=m,byrow = F)
a12<-matrix(sapply(strsplit(as.matrix(b1),sep),"[",2),nrow = nrow(b1),ncol=m,byrow = F)
a21<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",1),nrow = nrow(b2),ncol=m,byrow = F)
a22<-matrix(sapply(strsplit(as.matrix(b2),sep),"[",2),nrow = nrow(b2),ncol=m,byrow = F)
MAX <- data.frame(t(data.frame(a11 =as.numeric(a11),a12=as.numeric(a12),a21=as.numeric(a21),a22=as.numeric(a22))))
AS <- function(x){
a11 <- x[1]
a12 <- x[2]
a21 <- x[3]
a22 <- x[4]
ind1<-sort(c(a11,a12))
ind2<-sort(c(a21,a22))
if (identical(ind1,ind2)){
as <- 2
}else{
as <- length(intersect(ind1,ind2))
}
return(as)
}
output <-matrix(sapply(MAX, AS),nrow = nrow(b1),ncol = m)
colnames(output) <- colnames(g1)
pair <-rbind(rownames(b1),rownames(b2))
rownames(output)<-sapply(data.frame(pair),function(x){paste(x[1],x[2])})
return(output)
}
AlleleShare(g1,"\\|",replacement = T)
AlleleShare(g1,"\\|",replacement = F)
#######Dist_SimuChisq#######
require(mixIndependR)
h<-runif(10)
s<-Simulate_DistK(h,500,100)
Exp <- DistHetero(h)
Dist_SimuChisq(s,Exp$Density,10)
s
typeof(s)
t(s)
as.data.frame(t(s))
sapply(as.data.frame(t(s)), chisq.test,p=Exp$Density,simulate.p.value = T,B=10)
sapply(as.data.frame(t(s)), function(df){return(chisq.test(df,p=Exp$Density,simulate.p.value = T,B=10)$statistic)})
chival<-sapply(as.data.frame(t(s)), function(df){return(chisq.test(df,p=Exp$Density,simulate.p.value = T,B=10)$statistic)})
as.vector(chival)
######FreqAlleleShare######
g1
rm(AlleleShare)
document()
rm(n)
document()
######FreqAlleleShare######
AS <- AlleleShare(g1,"\\|")
######FreqAlleleShare######
AS <- AlleleShare(g1,"\\|",replacement = T)
?function
?function
document()
######FreqAlleleShare######
AS <- AlleleShare(g1,"\\|")
AS
######FreqAlleleShare######
AS <- AlleleShare(g1,"\\|",replacement = T)
AS
######FreqAlleleShare######
AS <- AlleleShare(g1,"\\|")
AS
document()
######FreqAlleleShare######
AS <- AlleleShare(g1)
AS
n<-ncol(AS)
X<-rowSums(AS)
X
for (i in 1:(2*n+1)){
Frequency[i] <- counta(X,(i-1))
}
Frequency <- rep.int(0,(2*n+1))
for (i in 1:(2*n+1)){
Frequency[i] <- counta(X,(i-1))
}
X_io <- c(0:(2*n))
df <- data.frame(X_io,Frequency)
df
X
table(X)
X_io <- c(0:(2*n))
X_io
sapply(c(0:2*n),counta,z=X)
X_io <- c(0:(2*n))
sapply(X_io,counta,z=X)
Freq<-sapply(X_io,counta,z=X)
document()
rm(n)
document()
AS
FreqAllelShare(AS)
FreqAlleleShare(AS)
document()
