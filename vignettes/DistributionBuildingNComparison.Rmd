---
title: "Distribution Building and Comparison"
description: Learn to use mixIndependR to build and compare observed and expected distributions of number of heterozygous loci (K) and number of shared alleles (X). 
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Distribution Building and Comparison}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
This vignette will introduce you to how the package `mixIndependR` will build and compare the observed and expected distributions for number of heterozygous loci (K) and number of shared alleles (X).


```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
```{r}
library(mixIndependR)
library(ggplot2)
```
With required parameters obtained from "basic genetics" part, observed and expected distributions can be built:

```{r,include=FALSE}
x <- data.frame(STR1=c("12|12","13|14","13|13","14|15","15|13","13|14","14|13","12|12","14|14","15|15"),SNP1=c("A|A","T|T","A|T","A|T","T|A","A|T","A|A","T|A","T|T","A|T"))

p <- AlleleFreq(x)
h <-Heterozygous(x)
H <- RxpHetero(h,p,HWE=FALSE)
AS<-AlleleShare(x,replacement =FALSE)
e <-RealProAlleleShare(AS)
```
`FreqHetero` and `DistHetero` build the observed and expected distribution for number of heterozygous loci (K).
```{r}
ObsDist_K<-FreqHetero(h)
ExpDist_K<- DistHetero(H)
head(ObsDist_K)
head(ExpDist_K)
```
`FreqAlleleShare` and `DistAlleleShare` build the observed and expected distribution for number of shared alleles (X).
```{r}
ObsDist_X<-FreqAlleleShare(AS)
ExpDist_X<-DistAlleleShare(e)
head(ObsDist_X)
head(ExpDist_X)
```
`ComposPare`s convert the above distributions into a format suitable for visualization. With the `trans=TRUE`, the observed frequencies and the expected density would be in separate columns. If `trans=FALSE`, two variables would be “OvE” (denoting the status of “observed or expected”) and “frequencies”.

```{r}
df_K <- ComposPare_K(h,ExpDist_K,trans = F)
df_X <- ComposPare_X(AS,ExpDist_X,trans = F)
```
```{r,fig.show='hold',echo=FALSE}

ggplot(df_K, aes(x=freq, color=OvE, fill=OvE)) +
            geom_histogram(aes(y=..density..), alpha=0.5,binwidth = 1,
                 position="identity")+
            geom_density(alpha=.2,bw=T) +
            ggtitle("Number of Heterozygous Loci")
ggplot(df_X, aes(x=freq, color=OvE, fill=OvE)) +
            geom_histogram(aes(y=..density..), alpha=0.5,binwidth = 1,
                 position="identity")+
            geom_density(alpha=.2,bw=T) +
            ggtitle("Number of Shared Alleles")
```
